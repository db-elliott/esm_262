---
title: "esm262_assignment5"
author: "Deanna Elliott"
date: '2023-03-08'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(purrr)
library(testthat)
library(ggplot2)
```

```{r}

# source flubber_power function
source("R/flubber_power.R")

#calculate power generated from a flubber sample with mass 10g (parameter), viscosity 250 cP (input), rotation speed 3.5 m/s (input), exposed to 210 lumens of brightness (parameter)

flubber_power(viscosity = 250, rotation = 3.5)

```

We have three samples of flubber, each with a mass of 10g, rotation speed of 2.5, and exposure to 210 lumens of brightness. Each has a different viscosity.

```{r for loop}

viscosity_vec <- c(2500, 5000, 10000)

# initialize blank df
results <- data.frame(matrix(nrow = length(viscosity_vec), ncol = 3))

# name df columns
colnames(results) <- c("viscosity", "power_lvl", "total_power")

# write the viscosity values into df
results[,1] <- viscosity_vec


# loop viscosity vector for power generation
for (i in seq_along(results$visc)) {
  
  # result temporarily stores the return vector in this iteration
  result <- flubber_power(viscosity = results$visc[i], rotation = 2.5, mass = 10, brightness = 210)
  
  # write each element of the temp result vector to current row of df
  results$power_lvl[i] <- result[1]
  results$total_power[i] <- result[2]
}

head(results)

```

```{r plot}

# create dot plot of for loop results

ggplot(results, aes(x = viscosity, y = total_power)) +
  geom_point(size = 4, color = "darkgreen", shape = 17) +
  labs(x = "Viscosity (cP)", y = "Power Generated (J)",
       title = "Total Power Generated by Flubber of Different Viscosities")

```

We have three samples of flubber, each with a mass of 10g and exposure to 210 lumens of brightness. Each has a different viscosity and rotation speed.

```{r pmap}

# flubber samples
viscosity_vec2 <- c(2500, 5000, 10000)
rotation_vec <- c(5, 7, 12)

#run a pmap for sample vectors
power = pmap(list(viscosity = viscosity_vec2, rotation = rotation_vec),
             flubber_power)

power

```


