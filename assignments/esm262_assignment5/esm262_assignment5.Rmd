---
title: "esm262_assignment5"
author: "Deanna Elliott"
date: '2023-03-08'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(purrr)
library(testthat)
library(ggplot2)
```

```{r}

# source flubber_power function
source("R/flubber_power.R")

#calculate power generated from a flubber sample with mass 10g (parameter), viscosity 250 cP (input), rotation speed 3.5 m/s (input), exposed to 210 lumens of brightness (parameter)

flubber_power(viscosity = 250, rotation = 3.5)

```

We have three samples of flubber, each with a mass of 10g, rotation speed of 2.5, and exposure to 210 lumens of brightness. Each has a different viscosity.

```{r for loop}

viscosity_vec <- c(2500, 5000, 10000)

results <- list()

# loop viscosity vector for power generation
for (i in seq_along(viscosity_vec)) {
  result <- flubber_power(viscosity = viscosity_vec[i], rotation = 2.5, mass = 10, brightness = 210)
  results[[i]] <- result
}

head(results)

flub_df <- rbind.data.frame(viscosity = viscosity_vec, power_gen = sapply(results, "[[", "total_power"))
### ONLY VISCOSITY IS IN DF, NOT TOTAL POWER  ????
```

```{r plot}

# create bar plot: viscosity vs total power generated
ggplot(flub_df, aes(x = viscosity, y = total_power)) +
  geompoint(size = 2.5)+
  labs(x = "Viscosity (cP)", y = "Power Generated (J)",
       title = "Total Power Generated by Flubber of Different Viscosities")
### FLUB_DF ONLY HOLDS VISCOSITY RIGHT NOW, NOT TOTAL POWER



### SHOULD LOOK LIKE THIS:

Viscosity <- c(2500, 5000, 10000)
Power_Level <- c(37800, 18900, 9450)
flubber_df <- data.frame(Viscosity, Power_Level)

# create bar plot: viscosity vs total power generated
ggplot(flubber_df, 
       aes(x = Viscosity, y = Power_Level)) +
  geom_point(size = 4, color = "darkgreen", shape = 17) +
  labs(x = "Viscosity (cP)", y = "Power Generated (J)",
       title = "Total Power Generated by Flubber of Different  Viscosities")
```

We have three samples of flubber, each with a mass of 10g and exposure to 210 lumens of brightness. Each has a different viscosity and rotation speed.

```{r pmap}

# flubber samples
viscosity_vec2 <- c(2500, 5000, 10000)
rotation_vec <- c(5, 7, 12)

#run a pmap for sample vectors
power = pmap(list(viscosity = viscosity_vec2, rotation = rotation_vec),
             flubber_power)

power

```


